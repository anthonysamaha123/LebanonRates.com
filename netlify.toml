# Netlify deployment configuration
[build]
  command = "npm install && npm run build"
  publish = "dist"

[build.environment]
  NODE_VERSION = "20.18.1"

# Redirects for clean URLs (optional - if you want /usd-lbp-today instead of /usd-lbp-today.html)
[[redirects]]
  from = "/usd-lbp-today"
  to = "/usd-lbp-today.html"
  status = 200

[[redirects]]
  from = "/eur-lbp-today"
  to = "/eur-lbp-today.html"
  status = 200

[[redirects]]
  from = "/official-rates"
  to = "/official-rates.html"
  status = 200

[[redirects]]
  from = "/convert"
  to = "/convert.html"
  status = 200

[[redirects]]
  from = "/fuel-prices-today"
  to = "/fuel-prices-today.html"
  status = 200

[[redirects]]
  from = "/gold-price-lebanon"
  to = "/gold-price-lebanon.html"
  status = 200

[[redirects]]
  from = "/about-faq"
  to = "/about-faq.html"
  status = 200

# Headers for security and caching
[[headers]]
  for = "/*.html"
  [headers.values]
    Cache-Control = "public, max-age=3600"

[[headers]]
  for = "/css/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000"

[[headers]]
  for = "/sitemap.xml"
  [headers.values]
    Cache-Control = "public, max-age=86400"

# API function configuration
[functions]
  directory = "netlify/functions"
  node_bundler = "esbuild"

# API endpoint for Lebanon gold prices
[[redirects]]
  from = "/api/lebanon-gold"
  to = "/.netlify/functions/lebanon-gold"
  status = 200
  force = false

# API endpoint for latest Loto results
[[redirects]]
  from = "/api/loto/latest"
  to = "/.netlify/functions/loto-latest"
  status = 200
  force = false

# Cron job for storing gold price history (every 15 minutes)
# Note: Using GitHub Actions for scheduled tasks (see .github/workflows/store-history.yml)
# The Netlify scheduled functions plugin is not needed since we use GitHub Actions
# If you want to use Netlify Cron instead, uncomment below and install the plugin:
# [[plugins]]
#   package = "@netlify/plugin-scheduled-functions"
# [functions.store-gold-history]
#   schedule = "*/15 * * * *"
